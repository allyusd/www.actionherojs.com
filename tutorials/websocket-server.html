<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="57x57" href="/static/images/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/images/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/images/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/images/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/images/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/images/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/images/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/images/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/images/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/images/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/images/icons/favicon-16x16.png"/><meta name="viewport" content="width=device-width"/><link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css"/><link rel="stylesheet" type="text/css" href="/static/css/bebasNeue.css"/><link rel="stylesheet" type="text/css" href="/static/css/animations.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Roboto:100,300,400,500,700,900" rel="stylesheet"/><title>Actionhero</title><script src="/static/js/googleAnalytics.js"></script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/u6zR1HFvb3ob74JCKqyW_/pages/tutorials/%5Bname%5D.js" as="script"/><link rel="preload" href="/_next/static/u6zR1HFvb3ob74JCKqyW_/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.c1a6d8f83ab8e8b22967.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.f5c6a08825093bab8aff.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-e414ce584900f22861b2.js" as="script"/><link rel="preload" href="/_next/static/chunks/61ad6c1814036fd599e79456e31cf275f706bd9f.a0185f4863cacb9913f3.js" as="script"/><link rel="preload" href="/_next/static/chunks/8d6ec85a319270c6f8cdd43de1511a904290d0f7.20560c676470eb39a724.js" as="script"/><link rel="preload" href="/_next/static/chunks/f080faea0e3ab4c9d7e7c63e48031b8f0f274ec4.1e1d23888a3493fe7ff0.js" as="script"/></head><body><div id="__next"><div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><header style="background-color:#2F5266"><div class="container"><nav style="background-color:#2F5266;padding-top:5px;margin-bottom:0;border:0" class="navbar navbar-expand navbar-light"><span class="navbar-brand"><a style="padding-top:0;margin-bottom:15px"><img src="/static/images/actionhero-logo-header-wordmark.svg" style="padding-top:14px;padding-bottom:20px"/></a></span><button type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse"><div class="d-none d-lg-block navbar-nav"><div class="nav-item"> </div><div class="nav-item"> </div></div><div class="navbar-nav"><div class="d-none d-lg-block nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Why Actionhero</span></div><div class="d-none d-md-block nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Downloads</span></div><div class="nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Tutorials</span></div><div class="nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Documentation</span></div><div class="d-none d-lg-block nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Plugins</span></div><div class="d-none d-md-block nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Community</span></div><div class="d-none d-xlg-block nav-item"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;margin-right:20px">Shop</span></div></div><div class="navbar-nav"><div class="d-none d-lg-block"><a style="text-decoration:none" href="/get-started"><button style="font-family:Roboto, sans-serif;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;font-weight:300;margin-bottom:0;margin-left:10px;margin-right:10px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Get Started</button></a></div></div></div></nav></div></header></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="background-color:#FBF9E4;color:#2F5266;font-weight:200;padding:50px"><div class="container"><div class="row"><div style="text-align:center" class="col-md-3"><img src="/static/images/documentation.svg"/></div><div style="text-align:center" class="col-md-6"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><br/>Websocket-server</h1></div><div class="col-md-3"></div></div></div></div><div style="height:183px;background:url(&quot;/static/images/clouds-white.svg&quot;) no-repeat center #FBF9E4"></div><div style="padding-bottom:100px" class="container"><div class="row"><div id="_top"></div><div id="docPageContent" class="col-md-12"><div id="tutorialPageContent" class="row"><div class="col-md-9"><div><div id="Overview"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Overview</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>Actionhero uses <a href="https://github.com/primus/primus">Primus</a> for web socket connections. The Primus project allows you to choose from many websocket backends, including <code>ws</code>, <code>engine.io</code>, <code>socket.io</code>, and more. Within Actionhero, web sockets are bound to the web server (either http or https).</p><p>Actionhero will generate the client-side javascript needed for you (based on the ActionheroWebsocketClient library, primus, and the underlying ws transport). This file is regenerated each time you boot the application.</p><div><div id="Connection Details"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Connection Details</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>// In the Browser...
<span style="color:#000080;font-weight:normal">&lt;<span style="color:#000080;font-weight:normal">script</span> <span class="hljs-attr">src</span>=<span style="color:#219161">&quot;/public/javascript/ActionheroWebsocketClient.js&quot;</span>&gt;</span><span style="color:#000080;font-weight:normal">&lt;/<span style="color:#000080;font-weight:normal">script</span>&gt;</span>

<span style="color:#000080;font-weight:normal">&lt;<span style="color:#000080;font-weight:normal">script</span>&gt;</span><span class="javascript">
  client = <span style="color:#954121">new</span> ActionheroWebsocketClient();

  client.on(<span style="color:#219161">&quot;connected&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f"></span>) </span>{
    <span style="color:#0086b3">console</span>.log(<span style="color:#219161">&quot;connected!&quot;</span>);
  });
  client.on(<span style="color:#219161">&quot;disconnected&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f"></span>) </span>{
    <span style="color:#0086b3">console</span>.log(<span style="color:#219161">&quot;disconnected :(&quot;</span>);
  });

  client.on(<span style="color:#219161">&quot;error&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">error</span>) </span>{
    <span style="color:#0086b3">console</span>.log(<span style="color:#219161">&quot;error&quot;</span>, error.stack);
  });
  client.on(<span style="color:#219161">&quot;reconnect&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f"></span>) </span>{
    <span style="color:#0086b3">console</span>.log(<span style="color:#219161">&quot;reconnect&quot;</span>);
  });
  client.on(<span style="color:#219161">&quot;reconnecting&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f"></span>) </span>{
    <span style="color:#0086b3">console</span>.log(<span style="color:#219161">&quot;reconnecting&quot;</span>);
  });

  <span style="color:#408080;font-style:italic">// this will log all messages send the client</span>
  <span style="color:#408080;font-style:italic">// client.on(&#x27;message&#x27;,      function(message){ console.log(message) })</span>

  client.on(<span style="color:#219161">&quot;alert&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">message</span>) </span>{
    alert(message);
  });
  client.on(<span style="color:#219161">&quot;api&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">message</span>) </span>{
    alert(message);
  });

  client.on(<span style="color:#219161">&quot;welcome&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">message</span>) </span>{
    appendMessage(message);
  });
  client.on(<span style="color:#219161">&quot;say&quot;</span>, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">message</span>) </span>{
    appendMessage(message);
  });

  client.connect(<span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">error, details</span>) </span>{
    <span style="color:#954121">if</span> (error != <span style="color:#954121">null</span>) {
      <span style="color:#0086b3">console</span>.log(error);
    } <span style="color:#954121">else</span> {
      client.roomAdd(<span style="color:#219161">&quot;defaultRoom&quot;</span>);
      client.action(<span style="color:#219161">&quot;someAction&quot;</span>, { <span class="hljs-attr">key</span>: <span style="color:#219161">&quot;k&quot;</span>, <span class="hljs-attr">value</span>: <span style="color:#219161">&quot;v&quot;</span> }, <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">data</span>) </span>{
        <span style="color:#408080;font-style:italic">// do stuff</span>
      });
    }
  });
</span><span style="color:#000080;font-weight:normal">&lt;/<span style="color:#000080;font-weight:normal">script</span>&gt;</span></code></pre><p><code>connection.type</code> for a webSocket client is &quot;websocket&quot;. This type will not change regardless of if the client has fallen back to another protocol.</p><p>Data is always returned as JSON objects to the webSocket client.</p><p>An example web socket session might be the following:</p><p>You can also inspect <code>client.state</code> (‘connected&#x27;, ‘disconnected&#x27;, etc). The websocket client will attempt to re-connect automatically.</p><p>If you want to communicate with a websocket client outside of an action, you can call <code>connection.send(message)</code> on the server. In the client lib, the event message will be fired. So, client.on(&#x27;message, function(m){ ... })<code>. Be sure to add some descriptive content to the message you send from the sever (like perhaps {&quot;type&quot;: &#x27;message type&#x27;}</code>) so you can route message types on the client.</p><div><div id="Linking WebSockets to Web Clients"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Linking WebSockets to Web Clients</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>Actionhero provides <code>connection.fingerprint</code> where available to help you link websocket connections to related web connections. While every connection will always have a unique <code>connection.id</code>, we attempt to build <code>connection.fingerprint</code> by checking the headers the websocket connection began with. If the cookie defined by <code>api.config.servers.web.fingerprint.cookieKey</code> is present, we will store its value on the websocket connection.</p><p>You can read more about using a value like <code>connection.fingerprint</code> in an <a href="tutorials/middleware">authentication middleware</a> or using it as a key for session information.</p><div><div id="Config Options"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Config Options</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">export</span> <span style="color:#954121">const</span> DEFAULT = {
  servers: {
    websocket: <span class="hljs-function"><span style="color:#00f">config</span> =&gt;</span> {
      <span style="color:#954121">return</span> {
        enabled: <span style="color:#954121">true</span>,
        <span style="color:#408080;font-style:italic">// you can pass a FQDN (string) here or &#x27;window.location.origin&#x27;</span>
        clientUrl: <span style="color:#219161">&quot;window.location.origin&quot;</span>,
        <span style="color:#408080;font-style:italic">// Directory to render client-side JS.</span>
        <span style="color:#408080;font-style:italic">// Path should start with &quot;/&quot; and will be built starting from api.config..general.paths.public</span>
        clientJsPath: <span style="color:#219161">&quot;javascript/&quot;</span>,
        <span style="color:#408080;font-style:italic">// the name of the client-side JS file to render.  Both `.js` and `.min.js` versions will be created</span>
        <span style="color:#408080;font-style:italic">// do not include the file extension</span>
        <span style="color:#408080;font-style:italic">// set to `undefined` to not render the client-side JS on boot</span>
        clientJsName: <span style="color:#219161">&quot;ActionheroWebsocketClient&quot;</span>,
        <span style="color:#408080;font-style:italic">// should the server signal clients to not reconnect when the server is shutdown/reboot</span>
        destroyClientsOnShutdown: <span style="color:#954121">false</span>,

        <span style="color:#408080;font-style:italic">// websocket Server Options:</span>
        server: {
          <span style="color:#408080;font-style:italic">// authorization: null,</span>
          <span style="color:#408080;font-style:italic">// pathname:      &#x27;/primus&#x27;,</span>
          <span style="color:#408080;font-style:italic">// parser:        &#x27;JSON&#x27;,</span>
          <span style="color:#408080;font-style:italic">// transformer:   &#x27;websockets&#x27;,</span>
          <span style="color:#408080;font-style:italic">// plugin:        {},</span>
          <span style="color:#408080;font-style:italic">// timeout:       35000,</span>
          <span style="color:#408080;font-style:italic">// origins:       &#x27;*&#x27;,</span>
          <span style="color:#408080;font-style:italic">// methods:       [&#x27;GET&#x27;,&#x27;HEAD&#x27;,&#x27;PUT&#x27;,&#x27;POST&#x27;,&#x27;DELETE&#x27;,&#x27;OPTIONS&#x27;],</span>
          <span style="color:#408080;font-style:italic">// credentials:   true,</span>
          <span style="color:#408080;font-style:italic">// maxAge:        &#x27;30 days&#x27;,</span>
          <span style="color:#408080;font-style:italic">// exposed:       false,</span>
        },

        <span style="color:#408080;font-style:italic">// websocket Client Options:</span>
        client: {
          apiPath: <span style="color:#219161">&quot;/api&quot;</span>, <span style="color:#408080;font-style:italic">// the api base endpoint on your Actionhero server</span>
          <span style="color:#408080;font-style:italic">// the cookie name we should use for shared authentication between WS and web connections</span>
          cookieKey: config.servers.web.fingerprintOptions.cookieKey
          <span style="color:#408080;font-style:italic">// reconnect:        {},</span>
          <span style="color:#408080;font-style:italic">// timeout:          10000,</span>
          <span style="color:#408080;font-style:italic">// ping:             25000,</span>
          <span style="color:#408080;font-style:italic">// pong:             10000,</span>
          <span style="color:#408080;font-style:italic">// strategy:         &quot;online&quot;,</span>
          <span style="color:#408080;font-style:italic">// manual:           false,</span>
          <span style="color:#408080;font-style:italic">// websockets:       true,</span>
          <span style="color:#408080;font-style:italic">// network:          true,</span>
          <span style="color:#408080;font-style:italic">// transport:        {},</span>
          <span style="color:#408080;font-style:italic">// queueSize:        Infinity,</span>
        }
      };
    }
  }
};</code></pre><p>You can create your client with options. Options for both the server and client are stored in <code>/config/servers/websocket.ts</code>. Note there are 2 sections: <code>server</code> and <code>client</code>.</p></div><div class="d-none d-md-block col-md-3"><div style="height:0"><div style="padding-top:90px;position:sticky;top:0"><ul style="list-style-type:none;padding-left:0;margin-left:0"></ul></div></div></div></div><br/><div><a style="text-decoration:none" href="/tutorials"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Back to Tutorials</button></a></div></div><div class="d-none d-md-block col-md-3"></div></div></div><div style="background-color:#6E8898;color:#2F5266;font-weight:300;padding-top:100px;padding-bottom:100px"><div class="container"><div class="row"><div class="col-md-2"></div><div style="text-align:center;color:#FBF9E4;padding-bottom:100px" class="col-md-8"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Solutions</h1><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="color:#FBF9E4">Actionhero was built from the ground up to include all the features you expect from a modern API framework.</span></h2></div><div class="col-md-2"></div></div><div class="row"><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-left:40px;padding-right:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Open Source</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>The Actionhero server is open source, under the Apache-2 license</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>Actionhero runs on Linux, OS X, and Windows</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>You always have access to the Actionhero team via<!-- --> <a href="/community">Slack and Github</a></p><br/><br/><div><a style="text-decoration:none" href="/downloads"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Download</button></a></div></div></div><div class="d-lg-none col-md-4"><div style="width:100%;padding:20px;background-color:#2F5266;color:#FFFFFF;box-shadow:0px 2px 4px #003C51"><div style="text-align:center"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><span style="color:#FBF9E4">Premium Training &amp; Review</span></h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Audits</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div><div class="d-none d-lg-block col-md-4"><div style="width:125%;padding:40px;background-color:#2F5266;color:#FFFFFF;position:relative;top:-60px;box-shadow:0px 2px 4px #003C51;margin-left:-13%;margin-right:-5%;z-index:10"><div style="text-align:center;padding-bottom:10px"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Premium Training &amp; Review</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Workshops</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-right:40px;padding-left:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Enterprise</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>For larger customers in need of a support contract, we offer an enterprise plan including everything in the Premium plan plus:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>24/7 access to core members of the Actionhero Team</strong></li><li><strong>Emergency response packages</strong></li><li><strong>Deployment support</strong></li><li><strong>...and custom development against Actionhero’s core as needed.</strong></li></ul><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div></div></div></div></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><footer id="footer-container" style="background-color:#2F5266;color:#FBF9E4;font-family:Roboto, sans-serif;font-weight:200"><div class="container"><div style="padding-bottom:50px;padding-top:50px;padding-left:100px" class="row"><div class="col-md-12"><img src="/static/images/actionhero-logo-header-wordmark.svg"/></div></div><div style="padding-bottom:100px" class="row"><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/terms">Terms</a></p><p>Contact us at<!-- --> <a style="color:#FBF9E4;font-weight:500" href="mailto:hello@actionherojs.com">hello@actionherojs.com</a></p><p>You can contribute to this website<!-- --> <a style="color:#FBF9E4;font-weight:500" href="https://github.com/actionhero/www.actionherojs.com" target="_blank">here</a>.</p><p><a href="https://medium.com/tag/actionherojs/latest" target="_new" style="color:#FBF9E4">Blogs</a></p><p style="color:#FFFFFF;font-weight:bold">© 2020<!-- --> <!-- -->Actionhero</p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/why">Why Actionhero</a></p><p><a style="color:#FBF9E4" href="/get-started">Get Started</a></p><p><a href="https://docs.actionherojs.com" style="color:#FBF9E4">Documenation</a></p><p><a style="color:#FBF9E4" href="/solutions">Solutions</a></p><p><a style="color:#FBF9E4" href="/community">Community</a></p><p><a style="color:#FBF9E4" href="/downloads">Downloads</a></p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a href="https://www.npmjs.com/package/actionhero" target="_new" style="color:#FBF9E4">NPM</a></p><p><a href="https://twitter.com/actionherojs" target="_new" style="color:#FBF9E4">Twitter</a></p><p><a href="https://slack.actionherojs.com/" target="_new" style="color:#FBF9E4">Slack</a></p><p><a href="https://github.com/Actionhero/Actionhero" target="_new" style="color:#FBF9E4">Github</a></p><p><a href="https://actionherojs.threadless.com" target="_new" style="color:#FBF9E4">Shop</a></p></div></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"markdown":"## Overview\n\nActionhero uses [Primus](https://github.com/primus/primus) for web socket connections. The Primus project allows you to choose from many websocket backends, including `ws`, `engine.io`, `socket.io`, and more. Within Actionhero, web sockets are bound to the web server (either http or https).\n\nActionhero will generate the client-side javascript needed for you (based on the ActionheroWebsocketClient library, primus, and the underlying ws transport). This file is regenerated each time you boot the application.\n\n## Connection Details\n\n```html\n// In the Browser...\n\u003cscript src=\"/public/javascript/ActionheroWebsocketClient.js\"\u003e\u003c/script\u003e\n\n\u003cscript\u003e\n  client = new ActionheroWebsocketClient();\n\n  client.on(\"connected\", function() {\n    console.log(\"connected!\");\n  });\n  client.on(\"disconnected\", function() {\n    console.log(\"disconnected :(\");\n  });\n\n  client.on(\"error\", function(error) {\n    console.log(\"error\", error.stack);\n  });\n  client.on(\"reconnect\", function() {\n    console.log(\"reconnect\");\n  });\n  client.on(\"reconnecting\", function() {\n    console.log(\"reconnecting\");\n  });\n\n  // this will log all messages send the client\n  // client.on('message',      function(message){ console.log(message) })\n\n  client.on(\"alert\", function(message) {\n    alert(message);\n  });\n  client.on(\"api\", function(message) {\n    alert(message);\n  });\n\n  client.on(\"welcome\", function(message) {\n    appendMessage(message);\n  });\n  client.on(\"say\", function(message) {\n    appendMessage(message);\n  });\n\n  client.connect(function(error, details) {\n    if (error != null) {\n      console.log(error);\n    } else {\n      client.roomAdd(\"defaultRoom\");\n      client.action(\"someAction\", { key: \"k\", value: \"v\" }, function(data) {\n        // do stuff\n      });\n    }\n  });\n\u003c/script\u003e\n```\n\n`connection.type` for a webSocket client is \"websocket\". This type will not change regardless of if the client has fallen back to another protocol.\n\nData is always returned as JSON objects to the webSocket client.\n\nAn example web socket session might be the following:\n\nYou can also inspect `client.state` (‘connected', ‘disconnected', etc). The websocket client will attempt to re-connect automatically.\n\nIf you want to communicate with a websocket client outside of an action, you can call `connection.send(message)` on the server. In the client lib, the event message will be fired. So, client.on('message, function(m){ ... })`. Be sure to add some descriptive content to the message you send from the sever (like perhaps {\"type\": 'message type'}`) so you can route message types on the client.\n\n## Linking WebSockets to Web Clients\n\nActionhero provides `connection.fingerprint` where available to help you link websocket connections to related web connections. While every connection will always have a unique `connection.id`, we attempt to build `connection.fingerprint` by checking the headers the websocket connection began with. If the cookie defined by `api.config.servers.web.fingerprint.cookieKey` is present, we will store its value on the websocket connection.\n\nYou can read more about using a value like `connection.fingerprint` in an [authentication middleware](tutorials/middleware) or using it as a key for session information.\n\n## Config Options\n\n```ts\nexport const DEFAULT = {\n  servers: {\n    websocket: config =\u003e {\n      return {\n        enabled: true,\n        // you can pass a FQDN (string) here or 'window.location.origin'\n        clientUrl: \"window.location.origin\",\n        // Directory to render client-side JS.\n        // Path should start with \"/\" and will be built starting from api.config..general.paths.public\n        clientJsPath: \"javascript/\",\n        // the name of the client-side JS file to render.  Both `.js` and `.min.js` versions will be created\n        // do not include the file extension\n        // set to `undefined` to not render the client-side JS on boot\n        clientJsName: \"ActionheroWebsocketClient\",\n        // should the server signal clients to not reconnect when the server is shutdown/reboot\n        destroyClientsOnShutdown: false,\n\n        // websocket Server Options:\n        server: {\n          // authorization: null,\n          // pathname:      '/primus',\n          // parser:        'JSON',\n          // transformer:   'websockets',\n          // plugin:        {},\n          // timeout:       35000,\n          // origins:       '*',\n          // methods:       ['GET','HEAD','PUT','POST','DELETE','OPTIONS'],\n          // credentials:   true,\n          // maxAge:        '30 days',\n          // exposed:       false,\n        },\n\n        // websocket Client Options:\n        client: {\n          apiPath: \"/api\", // the api base endpoint on your Actionhero server\n          // the cookie name we should use for shared authentication between WS and web connections\n          cookieKey: config.servers.web.fingerprintOptions.cookieKey\n          // reconnect:        {},\n          // timeout:          10000,\n          // ping:             25000,\n          // pong:             10000,\n          // strategy:         \"online\",\n          // manual:           false,\n          // websockets:       true,\n          // network:          true,\n          // transport:        {},\n          // queueSize:        Infinity,\n        }\n      };\n    }\n  }\n};\n```\n\nYou can create your client with options. Options for both the server and client are stored in `/config/servers/websocket.ts`. Note there are 2 sections: `server` and `client`.\n","name":"websocket-server"}},"page":"/tutorials/[name]","query":{"name":"websocket-server"},"buildId":"u6zR1HFvb3ob74JCKqyW_","nextExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-b3d92c5385ed51ccd0d3.js"></script><script async="" data-next-page="/tutorials/[name]" src="/_next/static/u6zR1HFvb3ob74JCKqyW_/pages/tutorials/%5Bname%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/u6zR1HFvb3ob74JCKqyW_/pages/_app.js"></script><script src="/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" async=""></script><script src="/_next/static/chunks/framework.c1a6d8f83ab8e8b22967.js" async=""></script><script src="/_next/static/chunks/commons.f5c6a08825093bab8aff.js" async=""></script><script src="/_next/static/runtime/main-e414ce584900f22861b2.js" async=""></script><script src="/_next/static/chunks/61ad6c1814036fd599e79456e31cf275f706bd9f.a0185f4863cacb9913f3.js" async=""></script><script src="/_next/static/chunks/8d6ec85a319270c6f8cdd43de1511a904290d0f7.20560c676470eb39a724.js" async=""></script><script src="/_next/static/chunks/f080faea0e3ab4c9d7e7c63e48031b8f0f274ec4.1e1d23888a3493fe7ff0.js" async=""></script><script src="/_next/static/u6zR1HFvb3ob74JCKqyW_/_buildManifest.js" async=""></script><script src="/_next/static/u6zR1HFvb3ob74JCKqyW_/_ssgManifest.js" async=""></script></body></html>