<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="57x57" href="/static/images/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/images/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/images/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/images/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/images/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/images/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/images/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/images/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/images/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/images/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/images/icons/favicon-16x16.png"/><meta name="viewport" content="width=device-width"/><link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css"/><link rel="stylesheet" type="text/css" href="/static/css/bebasNeue.css"/><link rel="stylesheet" type="text/css" href="/static/css/animations.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Roboto:100,300,400,500,700,900" rel="stylesheet"/><title>Actionhero</title><script src="/static/js/googleAnalytics.js"></script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/AUafT0fS7I7zOGsKXeKYu/pages/tutorials/%5Bname%5D.js" as="script"/><link rel="preload" href="/_next/static/AUafT0fS7I7zOGsKXeKYu/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-91b117697e716c22a78b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.dbd31ae8fa0e794339d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.951ee3a86146f43ff3ef.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-a439f05c489a40fb8abf.js" as="script"/><link rel="preload" href="/_next/static/chunks/f5647245c8a086598a5876f74a9756c478cda1e9.df8ba5aacf2336156dd7.js" as="script"/><link rel="preload" href="/_next/static/chunks/7ece71603c6e374212d15adca87bfaf90f52a690.fee39761db1fc475c2ba.js" as="script"/><link rel="preload" href="/_next/static/chunks/48e7449b7a97b90df8cdc3151e72c92ec49f3594.f4cec1a1186f868c77e4.js" as="script"/></head><body><div id="__next"><div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="text-align:center;padding:10px;background-color:#FFFFFF;border-bottom:5px solid #E14E3A"><p><strong>We need your input!</strong><br/><br/>The Actionhero Team is working on our plans for 2020 and would like to solicit input from our community. <br/>Please take 5 to complete our<!-- --> <strong><a href="https://forms.gle/ZMmCqGN7pvgHKdz57" target="_blank">2020 Developer Survey</a></strong>! .</p></div><header style="background-color:#2F5266"><div class="container"><nav style="background-color:#2F5266;padding-top:5px;margin-bottom:10px;border:0" class="navbar navbar-default"><div class="container"><div class="navbar-header"><a style="padding-top:0;margin-bottom:15px" class="navbar-brand"><img src="/static/images/actionhero-logo-header-wordmark.svg" style="padding-top:14px;padding-bottom:20px"/></a><button type="button" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"></ul><ul class="hidden-md hidden-sm hidden-xs nav navbar-nav navbar-left"><li role="presentation" class=""><a role="button" href="#"> </a></li><li role="presentation" class=""><a role="button" href="#"> </a></li></ul><ul class="nav navbar-nav navbar-left"><li role="presentation" class="hidden-sm"><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Why Actionhero</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Downloads</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Tutorials</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Documentation</span></a></li><li role="presentation" class="hidden-sm"><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Plugins</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Community</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Shop</span></a></li></ul><ul class="nav navbar-nav navbar-right"><div><a style="text-decoration:none" href="/get-started"><button style="font-family:Roboto, sans-serif;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;font-weight:300;margin-top:20px;margin-bottom:0;margin-left:10px;margin-right:10px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Get Started</button></a></div></ul></div></div></nav></div></header></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="background-color:#FBF9E4;color:#2F5266;font-weight:200;padding:50px"><div class="container"><div class="row"><div style="text-align:center" class="col-md-3"><img src="/static/images/easy-to-use-actions.svg"/></div><div style="text-align:center" class="col-md-6"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><br/>Actions</h1></div><div class="col-md-3"></div></div></div></div><div style="height:183px;background:url(&quot;/static/images/clouds-white.svg&quot;) no-repeat center #FBF9E4"></div><div style="padding-bottom:100px" class="container"><div class="row"><div id="_top"></div><div id="docPageContent" class="col-md-12"><div id="tutorialPageContent" class="row"><div class="col-md-9"><div><div id="Overview"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Overview</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#408080;font-style:italic">// A simple Action</span>

<span style="color:#954121">import</span> { Action } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span style="color:#954121">export</span> <span style="color:#954121">class</span> RandomNumber <span style="color:#954121">extends</span> Action {
  <span style="color:#954121">constructor</span>(<span style="color:#00f"></span>) {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;randomNumber&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I am an API method which will generate a random number&quot;</span>;
    <span style="color:#954121">this</span>.outputExample = { randomNumber: <span style="color:#40a070">0.1234</span> };
  }

  <span style="color:#954121">async</span> run({ response }) {
    response.randomNumber = <span style="color:#0086b3">Math</span>.random();
  }
}</code></pre><p>The core of Actionhero is the Action framework, and <strong>actions</strong> are the basic units of work. All connection types from all servers can use actions. This means that you only need to write an action once, and both HTTP clients and websocket clients can consume it!</p><p>The goal of an action is to read <code>data.params</code> (which are the arguments a connection provides), do work, and set the <code>data.response</code> (and <code>data.response.error</code> when needed) values to build the response to the client.</p><p>You can create you own actions by placing them in a <code>./actions/</code> folder at the <code>src</code> directory of your application. You can use the generator with <code>actionhero generate action --name=myAction</code></p><p>You can also define more than one action per file if you would like, and extend classes to share common methods and components (like input parsers).</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#408080;font-style:italic">// A compound Action with Shared Inputs</span>

<span style="color:#954121">import</span> { Action } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">ValidatedAction</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">Action</span> </span>{
  <span style="color:#954121">constructor</span>() {
    <span style="color:#954121">super</span>();

    <span style="color:#954121">this</span>.inputs = {
      <span class="hljs-attr">email</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
        <span class="hljs-attr">validator</span>: <span style="color:#954121">this</span>.emailValidator
      },
      <span class="hljs-attr">password</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
        <span class="hljs-attr">validator</span>: <span style="color:#954121">this</span>.passwordValidator
      }
    };
  }

  emailValidator(param) {
    <span style="color:#954121">if</span> (param.indexOf(<span style="color:#219161">&quot;@&quot;</span>) &lt; <span style="color:#40a070">0</span>) {
      <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&quot;that is not a valid email address&quot;</span>);
    }
  }

  passwordValidator(param) {
    <span style="color:#954121">if</span> (param.length &lt;= <span style="color:#40a070">4</span>) {
      <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&quot;password should be at least 4 letters long&quot;</span>);
    }
  }
}

<span style="color:#408080;font-style:italic">// the actions</span>
<span style="color:#954121">export</span> <span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">UserAdd</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">ValidatedAction</span> </span>{
  <span style="color:#954121">constructor</span>() {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;userAdd&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I add a user&quot;</span>;
  }

  run(data) {
    <span style="color:#408080;font-style:italic">// your code here</span>
  }
}

<span style="color:#954121">export</span> <span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">UserDelete</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">ValidatedAction</span> </span>{
  <span style="color:#954121">constructor</span>() {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;userDelete&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I delete a user&quot;</span>;
  }

  run(data) {
    <span style="color:#408080;font-style:italic">// your code here</span>
  }
}</code></pre><div><div id="Versions"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Versions</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>Actionhero supports multiple versions of the same action. This will allow you to support actions/routes of the same name with upgraded functionality. To create actions of the same name with various versions, set the <code>version</code> parameter.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">import</span> { Action } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span style="color:#954121">export</span> <span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">ActionVersion1</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">Action</span> </span>{
  <span style="color:#954121">constructor</span>() {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;randomNumber&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I am an API method which will generate a random number&quot;</span>;
    <span style="color:#954121">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span style="color:#40a070">0.123</span> };
    <span style="color:#954121">this</span>.version = <span style="color:#40a070">1</span>;
  }

  <span style="color:#954121">async</span> run({ connection, response }) {
    response.version = <span style="color:#40a070">1</span>;
    response.randomNumber = <span style="color:#0086b3">Math</span>.random();
  }
};

exports <span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">ActionVersion2</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">Action</span> </span>{
  <span style="color:#954121">constructor</span>() {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;randomNumber&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I am an API method which will generate a random number&quot;</span>;
    <span style="color:#954121">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span style="color:#40a070">0.123</span> };
    <span style="color:#954121">this</span>.version = <span style="color:#40a070">2</span>;
  }

  <span style="color:#954121">async</span> run({ connection, response }) {
    response.version = <span style="color:#40a070">2</span>;
    <span style="color:#954121">const</span> number = <span style="color:#0086b3">Math</span>.random();
    response.randomNumber = connection.localize([
      <span style="color:#219161">&quot;Your random number is {{number}}&quot;</span>, { number }
    ]);
  }
};</code></pre><ul><li>actions optionally have the <code>this.version</code> attribute, which defaults to <code>1</code>.</li><li>a reserved param, <code>apiVersion</code> is used to directly specify the version of an action a client may request. You will likely want to check this in your <code>routes</code> file</li><li>if a client doesn&#x27;t specify an <code>apiVersion</code>, they will be directed to the highest numerical version of that action.</li></ul><p>You can optionally create routes to handle your API versioning:</p><p><em>As a note, if a client accessing Actionhero via routes does not provide an apiVersion and it is explicitly defined in the route, the highest number will not be assigned automatically, and will be seen as a routing error.</em></p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>exports.routes = {
  <span class="hljs-attr">all</span>: [
    <span style="color:#408080;font-style:italic">// creates routes like \`/api/myAction/1/\` and \`/api/myAction/2/\`</span>
    { <span class="hljs-attr">path</span>: <span style="color:#219161">&quot;/myAction/:apiVersion&quot;</span>, <span class="hljs-attr">action</span>: <span style="color:#219161">&quot;myAction&quot;</span> },

    <span style="color:#408080;font-style:italic">// creates routes like \`/api/v1/myAction/\` and \`/api/v2/myAction/\`</span>
    { <span class="hljs-attr">path</span>: <span style="color:#219161">&quot;/v:apiVersion/myAction&quot;</span>, <span class="hljs-attr">action</span>: <span style="color:#219161">&quot;myAction&quot;</span> }
  ]
};</code></pre><p>We go into more detail about routes when discussing the <a href="/tutorials/web-server">web server</a></p><div><div id="Options"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Options</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>The complete set of options an action can have are:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">import</span> { Action } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span class="hljs-class"><span style="color:#954121">class</span> <span style="color:#458;font-weight:bold">ValidatedAction</span> <span style="color:#954121">extends</span> <span style="color:#458;font-weight:bold">Action</span> </span>{
  <span style="color:#954121">constructor</span> () {
    <span style="color:#954121">super</span>()

    <span style="color:#408080;font-style:italic">// (required) the action&#x27;s name (the \`exports\` key doesn&#x27;t matter)</span>
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&#x27;randomNumber&#x27;</span>

    <span style="color:#408080;font-style:italic">// (required) the description</span>
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&#x27;I am an API method which will generate a random number&#x27;</span>

    <span style="color:#408080;font-style:italic">// (required) a hash of all the inputs this action will accept</span>
    <span style="color:#408080;font-style:italic">// any inputs provided to the action not in this hash will be stripped</span>
    <span style="color:#954121">this</span>.inputs = {
      <span class="hljs-attr">multiplier</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">false</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
          <span style="color:#954121">if</span> (param &lt; <span style="color:#40a070">0</span>) { <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&#x27;must be &gt; 0&#x27;</span>) }
        },
        <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
          <span style="color:#954121">return</span> <span style="color:#0086b3">parseInt</span>(param)
        },
        <span class="hljs-attr">default</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
          <span style="color:#954121">return</span> <span style="color:#40a070">1</span>
        },
      }
    },

    <span style="color:#408080;font-style:italic">// any middleware to apply before/after this action</span>
    <span style="color:#408080;font-style:italic">// global middleware will be applied automatically</span>
    <span style="color:#408080;font-style:italic">// default []</span>
    <span style="color:#954121">this</span>.middleware = []

    <span style="color:#408080;font-style:italic">// an example response</span>
    <span style="color:#408080;font-style:italic">// default: {}</span>
    <span style="color:#954121">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span style="color:#40a070">123</span> }

    <span style="color:#408080;font-style:italic">// you can choose to block certain servers from using this action</span>
    <span style="color:#408080;font-style:italic">// default: []</span>
    <span style="color:#954121">this</span>.blockedConnectionTypes = [<span style="color:#219161">&#x27;webSocket&#x27;</span>]

    <span style="color:#408080;font-style:italic">// how should this action be logged?</span>
    <span style="color:#408080;font-style:italic">// default: &#x27;info&#x27;</span>
    <span style="color:#954121">this</span>.logLevel = <span style="color:#219161">&#x27;warning&#x27;</span>

    <span style="color:#408080;font-style:italic">// (HTTP only) if the route for this action includes an extension (like .jpg), should the response MIME be adjusted to match?</span>
    <span style="color:#408080;font-style:italic">// default: true</span>
    <span style="color:#954121">this</span>.matchExtensionMimeType = <span style="color:#954121">true</span>

    <span style="color:#408080;font-style:italic">// should this action appear within \`api.documentation\`</span>
    <span style="color:#408080;font-style:italic">// default: true</span>
    <span style="color:#954121">this</span>.toDocument = <span style="color:#954121">true</span>

    <span style="color:#408080;font-style:italic">// (required) the run method of the action</span>
    <span style="color:#954121">async</span> run (data) {
      data.response.randomNumber = <span style="color:#0086b3">Math</span>.random() * data.params.multiplier;
    }
  }
}</code></pre><div><div id="Inputs"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Inputs</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>action.inputs = {
  <span style="color:#408080;font-style:italic">// a simple input</span>
  <span style="color:#408080;font-style:italic">// defaults assume required = false</span>
  minimalInput: {}

  <span style="color:#408080;font-style:italic">// a complex input</span>
  multiplier: {
    <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
      <span style="color:#954121">if</span> (param &lt; <span style="color:#40a070">0</span>) { <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&#x27;must be &gt; 0&#x27;</span>) }
    },
    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
      <span style="color:#954121">return</span> <span style="color:#0086b3">parseInt</span>(param);
    },
    <span class="hljs-attr">default</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
      <span style="color:#954121">return</span> <span style="color:#40a070">1</span>;
    },
  },

  <span style="color:#408080;font-style:italic">// a schema input</span>
  schemaInput: {
    <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
    <span class="hljs-attr">default</span>: {},
    <span class="hljs-attr">schema</span>: {
      <span class="hljs-attr">nestedInput</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
        <span class="hljs-attr">default</span>: <span style="color:#40a070">1</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
          <span style="color:#954121">if</span> (param &lt; <span style="color:#40a070">0</span>) { <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&#x27;must be &gt; 0&#x27;</span>) }
        },
        <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span style="color:#00f">param, connection, actionTemplate</span>) =&gt;</span> {
          <span style="color:#954121">return</span> <span style="color:#0086b3">parseInt</span>(param);
        },
      },
      <span class="hljs-attr">otherInput</span>: {},
    }
  }
};</code></pre><p>The properties of an input are:</p><ul><li><code>required</code> (boolean)<ul><li>Default: <code>false</code></li></ul></li><li><code>formatter = function(param, connection, actionTemplate)</code><ul><li>will return the new value of the param</li><li>Default: The parameter is not reformatted</li></ul></li><li><code>default = function(param, connection, actionTemplate)</code><ul><li>will return the default value of the param</li><li>you can also have a static assignment for <code>default</code> father than a function, ie: <code>default: 123</code></li><li>Default: Parameter has no default value</li></ul></li><li><code>validator = function(param, connection, actionTemplate)</code><ul><li>should return true, null, or undefined (return nothing) if validation passed</li><li>should throw an error message if validation fails which will be returned to the client</li><li>Default: Parameter is always valid</li></ul></li><li><code>schema</code> (object)<ul><li>optional nested inputs definition</li><li>accept <code>object</code> similar to regular input</li><li>nested input also have properties: <code>required</code>, <code>formatter</code>, <code>default</code> and <code>validator</code></li></ul></li></ul><p>You can define <code>config.general.missingParamChecks = [null, &#x27;&#x27;, undefined]</code> to choose explicitly how you want un-set params to be handled in your actions. For example, if you want to allow explicit <code>null</code> values in a JSON payload but not <code>undefined</code>, you can now opt-in to that behavior. This is what <code>action.inputs.x.required = true</code> will check against.<p></p></p><p>Since all properties of an input are optional, the smallest possible definition of an input is: <code>name : {}</code>. However, you should usually specify that an input is required (or not), ie: <code>{</code>name: {required: false}<code>}</code>.<p></p></p><p>The methods <code>default</code>, <code>formatter</code>, and <code>validator</code> have the api object set as <code>this</code> within their scopes. This means that you can define common formatters within middleware and reference them in each action.<p></p></p><p>The methods are applied in this order:<p></p></p><ul><li><code>default()</code></li><li><code>formatter()</code></li><li><code>validator()</code></li><li><code>required()</code></li></ul><p>Here&#x27;s an example...</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>moneyInCents: {
  <span class="hljs-attr">required</span>:  <span style="color:#954121">true</span>,
  <span class="hljs-attr">default</span>:   <span class="hljs-function">(<span style="color:#00f">p</span>) =&gt;</span> { <span style="color:#954121">return</span> <span style="color:#40a070">0</span> },
  <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span style="color:#00f">p</span>) =&gt;</span> { <span style="color:#954121">return</span> <span style="color:#0086b3">parseFloat</span>(p) },
  <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span style="color:#00f">p</span>) =&gt;</span> {
    <span style="color:#954121">if</span>(<span style="color:#0086b3">isNaN</span>(<span style="color:#0086b3">parseFloat</span>(p)){ <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&#x27;not a number&#x27;</span>) }
    <span style="color:#954121">if</span>(p &lt; <span style="color:#40a070">0</span>){ <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&#x27;money cannot be negative&#x27;</span>) }
  }
}</code></pre><p>Formatters and Validators can also be named method names. For example, you might have an action like:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>inputs: {
  <span class="hljs-attr">key</span>: {
    <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
    <span class="hljs-attr">formatter</span>: <span style="color:#219161">&#x27;api.formatter.uniqueKeyName&#x27;</span>
  }
}</code></pre><p>You can define <code>api.formatter.uniqueKeyName</code> elsewhere in your project.</p><p>Example schema input:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>inputs = {
  <span class="hljs-attr">firstName</span>: { <span class="hljs-attr">required</span>: <span style="color:#954121">true</span> },
  <span class="hljs-attr">lastName</span>: { <span class="hljs-attr">required</span>: <span style="color:#954121">false</span> },
  <span class="hljs-attr">username</span>: { <span class="hljs-attr">required</span>: <span style="color:#954121">true</span> },
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">required</span>: <span style="color:#954121">false</span>,
    <span class="hljs-attr">schema</span>: {
      <span class="hljs-attr">country</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
        <span class="hljs-attr">default</span>: <span style="color:#219161">&quot;USA&quot;</span>
      },
      <span class="hljs-attr">state</span>: { <span class="hljs-attr">required</span>: <span style="color:#954121">false</span> },
      <span class="hljs-attr">city</span>: {
        <span class="hljs-attr">required</span>: <span style="color:#954121">true</span>,
        <span class="hljs-attr">formatter</span>: <span class="hljs-function"><span style="color:#00f">val</span> =&gt;</span> <span style="color:#219161">`City:\${val}`</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-function"><span style="color:#00f">val</span> =&gt;</span> val.length &gt; <span style="color:#40a070">10</span>
      }
    }
  }
};</code></pre><div><div id="Extending the Action class"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Extending the Action class</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>There may be times that you want add properties to the Action class. A common reason for this is to work with middleware, adding a property to your action that controls how authentication might work, etc. With typescript, adding arbitrary properties to class (interface) will produce an error, as we don&#x27;t have a type definition for your new property. The way to overcome this is to extend the Action class with your new property.</p><p>The example below creates a new class, <code>AuthenticatedAction</code> which adds a boolean <code>authenticated</code> to the action. A global action middleware then checks if the action should be <code>authenticated</code>, and if it does, it checks for a password.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">import</span> { Action, action } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span style="color:#954121">abstract</span> <span style="color:#954121">class</span> AuthenticatedAction <span style="color:#954121">extends</span> Action {
  <span style="color:#408080;font-style:italic">/**
   * does this action require the user to be logged in?
   */</span>
  authenticated: <span style="color:#0086b3">boolean</span>;
}

action.addMiddleware({
  name: <span style="color:#219161">&quot;Authentication Middleware&quot;</span>,
  global: <span style="color:#954121">true</span>,
  preProcessor({ params, actionTemplate }) {
    <span style="color:#408080;font-style:italic">// we have access to the action&#x27;s template here, which now will contain &quot;authenticated: boolean&quot;</span>
    <span style="color:#954121">if</span> (actionTemplate.authenticated) {
      <span style="color:#954121">if</span> (params.password !== <span style="color:#219161">&quot;thePassw0rd&quot;</span>) {
        <span style="color:#408080;font-style:italic">// it the request does not include the param &quot;password=thePassw0rd&quot;, the action will not be run</span>
        <span style="color:#408080;font-style:italic">// this is bad authentication strategy, but hopefully serves as a good example</span>
        <span style="color:#954121">throw</span> <span style="color:#954121">new</span> <span style="color:#0086b3">Error</span>(<span style="color:#219161">&quot;bad password&quot;</span>);
      }
    }
  }
});

<span style="color:#954121">export</span> <span style="color:#954121">class</span> ShowDashboard <span style="color:#954121">extends</span> AuthenticatedAction {
  <span style="color:#954121">constructor</span>(<span style="color:#00f"></span>) {
    <span style="color:#954121">super</span>();
    <span style="color:#954121">this</span>.name = <span style="color:#219161">&quot;showDashboard&quot;</span>;
    <span style="color:#954121">this</span>.description = <span style="color:#219161">&quot;I return the authenticated user&#x27;s dashboard data&quot;</span>;
    <span style="color:#408080;font-style:italic">// without the AutheticatedAction class, this would throw an error, as &quot;authenticated&quot; is not a property of the class &quot;Action&quot;</span>
    <span style="color:#954121">this</span>.authenticated = <span style="color:#954121">true</span>;
  }

  <span style="color:#954121">async</span> run({ response }) {
    <span style="color:#408080;font-style:italic">// your logic would be here...</span>
    response.dashboard = <span style="color:#954121">true</span>;
  }
}

<span style="color:#408080;font-style:italic">/**
 * ❯ curl &quot;http://localhost:8080/api/showDashboard&quot;
 * { &quot;error&quot;: &quot;bad password&quot; }
 *
 * ❯ curl &quot;http://localhost:8080/api/showDashboard?password=thePassw0rd&quot;
 * { &quot;dashboard&quot;: true }
 */</span></code></pre><div><div id="The Data Object"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">The Data Object</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>The <code>data</code> object passed into your action captures the state of the connection at the time the action was started. Middleware preProcessors have already fired, and input formatting and validation has occurred. Here are the properties of the <code>data</code> object.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code>data = {
  <span class="hljs-attr">connection</span>: connection,
  <span class="hljs-attr">action</span>: <span style="color:#219161">&quot;randomNumber&quot;</span>,
  <span class="hljs-attr">toProcess</span>: <span style="color:#954121">true</span>,
  <span class="hljs-attr">toRender</span>: <span style="color:#954121">true</span>,
  <span class="hljs-attr">messageId</span>: <span style="color:#40a070">123</span>,
  <span class="hljs-attr">params</span>: { <span class="hljs-attr">action</span>: <span style="color:#219161">&quot;randomNumber&quot;</span>, <span class="hljs-attr">apiVersion</span>: <span style="color:#40a070">1</span> },
  <span class="hljs-attr">actionStartTime</span>: <span style="color:#40a070">123</span>,
  <span class="hljs-attr">response</span>: {},
  <span class="hljs-attr">session</span>: {}
};</code></pre><p>The goal of most actions is to do work and then modify the value of <code>data.response</code>, which will eventually be sent down to the client.</p><p>You can also modify properties of the connection by accessing <code>data.connection</code>, IE changing the response header for a HTTP request.</p><p>If you don&#x27;t want your action to respond to the client, or you have already sent data to the client (perhaps you already rendered a file to them or sent an error HTTP header), you can set <code>data.toRender = false;</code></p><p>If you are certain that your action is only going to be handled by a web server, then a convenience method has been provided to you via <code>data.connection.setHeader()</code>. This function is a proxy to the <a href="https://nodejs.org/api/http.html#http_response_setheader_name_value">Node HTTP Response setHeader</a> function and allows you to set response headers without having to drill into the <code>data.connection.rawConnection</code> object. Please be aware, the <code>data.connection.setHeader()</code> function will only be available if your action is being handled by a web server. Other server types will throw an exception. See <a href="/tutorial/servers">Servers: Customizing the Connection</a> for more details.</p><p>Similarly to the above, the web server also exposes <code>data.connection.setStatusCode()</code>, again only for actions in use by the web server. This can be used as a helper to set the HTTP responses&#x27; status code, ie: 404, 200, etc.</p><p>Finally, if your action is again only for the web server, you can send a string or buffer as a file response with <code>data.connection.pipe(buffer, headers)</code>. You will still need to set <code>data.toRender = false</code> in your action to avoid double-sending a response to the client.</p><div><div id="Middleware"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Middleware</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>You can create middleware which would apply to the connection both before and after an action. Middleware can be either global (applied to all actions) or local, specified in each action via <code>action.middleware = []</code>. Supply the <code>names</code> of any middleware you want to use.</p><p>You can <a href="/tutorials/middleware">learn more about middleware here</a>.</p><div><div id="Notes"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Notes</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><ul><li>Actions&#x27; run methods are async, and have <code>data</code> as their only argument. Completing an action is as simple returning from the method.</li><li>If you throw an error, be sure that it is a <code>new Error()</code> object, and not a string. Thrown errors will automatically be sent to the client in <code>response.error</code>. Also, throw Errors are processed at <code>config/errors.js</code> in <code>genericError(data, error)</code>. Here you can check your error add to the response (<code>requestIds</code>, status codes, etc.)</li><li>The metadata <code>outputExample</code> is used in reflexive and self-documenting actions in the API, available via the <code>documentation</code> verb (and showDocumentation action).</li><li>You can limit how many actions a persistent client (websocket, tcp, etc) can have pending at once with <code>api.config.general.simultaneousActions</code></li><li><code>actions.inputs</code> are used for both documentation and for building the whitelist of allowed parameters the API will accept. Client params not included in these whitelists will be ignored for security. If you wish to disable the whitelisting you can use the flag at <code>api.config.general.disableParamScrubbing</code>. Note that <a href="tutorial-middleware.html">Middleware</a> preProcessors will always have access to all params pre-scrubbing.</li><li><code>matchExtensionMimeType</code> is currently only used by the <code>web</code> server, and it indicates that if this action is successfully called by a client with <code>connection.extension</code> set, the headers of the response should be changed to match that file type. This is useful when creating actions that download files.</li><li>Actionhero strives to keep the <code>data.connection</code> object uniform among various client types, and more importantly, present <code>data.params</code> in a homogeneous way to actions. You can inspect <code>data.connection.type</code> to learn more about the connection. The gory details of the connection (which vary on its type) are stored in <code>data.connection.rawConnection</code> which will contain the websocket, tcp connection, etc. For web clients, <code>{</code>data.connection.rawConnection = {req: req, res: res}<code>}</code> for example.</li></ul><p><a href="/tutorials/web-server">You can learn more about handling HTTP verbs and file uploads here</a> and <a href="/tutorials/websocket-server">Web-Socket Clients</a>.</p></div><div class="hidden-xs hidden-sm col-md-3"><div style="height:0"><div style="padding-top:90px;position:sticky;top:0"><ul style="list-style-type:none;padding-left:0;margin-left:0"></ul></div></div></div></div><br/><div><a style="text-decoration:none" href="/tutorials"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Back to Tutorials</button></a></div></div><div class="hidden-xs hidden-sm col-md-3"></div></div></div><div style="background-color:#6E8898;color:#2F5266;font-weight:300;padding-top:100px;padding-bottom:100px"><div class="container"><div class="row"><div class="col-md-2"></div><div style="text-align:center;color:#FBF9E4;padding-bottom:100px" class="col-md-8"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Solutions</h1><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="color:#FBF9E4">Actionhero was built from the ground up to include all the features you expect from a modern API framework.</span></h2></div><div class="col-md-2"></div></div><div class="row"><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-left:40px;padding-right:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Open Source</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>The Actionhero server is open source, under the Apache-2 license</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>Actionhero runs on Linux, OS X, and Windows</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>You always have access to the Actionhero team via<!-- --> <a href="/community">Slack and Github</a></p><br/><br/><div><a style="text-decoration:none" href="/downloads"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Download</button></a></div></div></div><div class="hidden-md hidden-lg hidden-xl col-md-4"><div style="width:100%;padding:20px;background-color:#2F5266;color:#FFFFFF;box-shadow:0px 2px 4px #003C51"><div style="text-align:center"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><span style="color:#FBF9E4">Premium Training &amp; Review</span></h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Audits</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div><div class="hidden-xs hidden-sm col-md-4"><div style="width:125%;padding:40px;background-color:#2F5266;color:#FFFFFF;position:relative;top:-60px;box-shadow:0px 2px 4px #003C51;margin-left:-13%;margin-right:-5%;z-index:10"><div style="text-align:center;padding-bottom:10px"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Premium Training &amp; Review</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Workshops</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-right:40px;padding-left:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Enterprise</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>For larger customers in need of a support contract, we offer an enterprise plan including everything in the Premium plan plus:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>24/7 access to core members of the Actionhero Team</strong></li><li><strong>Emergency response packages</strong></li><li><strong>Deployment support</strong></li><li><strong>...and custom development against Actionhero’s core as needed.</strong></li></ul><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div></div></div></div></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><footer id="footer-container" style="background-color:#2F5266;color:#FBF9E4;font-family:Roboto, sans-serif;font-weight:200"><div class="container"><div style="padding-bottom:50px;padding-top:50px;padding-left:100px" class="row"><div class="col-md-12"><img src="/static/images/actionhero-logo-header-wordmark.svg"/></div></div><div style="padding-bottom:100px" class="row"><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/terms">Terms</a></p><p>Contact us at<!-- --> <a style="color:#FBF9E4;font-weight:500" href="mailto:hello@actionherojs.com">hello@actionherojs.com</a></p><p>You can contribute to this website<!-- --> <a style="color:#FBF9E4;font-weight:500" href="https://github.com/actionhero/www.actionherojs.com" target="_blank">here</a>.</p><p><a href="https://medium.com/tag/actionherojs/latest" target="_new" style="color:#FBF9E4">Blogs</a></p><p style="color:#FFFFFF;font-weight:bold">© 2020<!-- --> <!-- -->Actionhero</p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/why">Why Actionhero</a></p><p><a style="color:#FBF9E4" href="/get-started">Get Started</a></p><p><a href="https://docs.actionherojs.com" style="color:#FBF9E4">Documenation</a></p><p><a style="color:#FBF9E4" href="/solutions">Solutions</a></p><p><a style="color:#FBF9E4" href="/community">Community</a></p><p><a style="color:#FBF9E4" href="/downloads">Downloads</a></p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a href="https://www.npmjs.com/package/actionhero" target="_new" style="color:#FBF9E4">NPM</a></p><p><a href="https://twitter.com/actionherojs" target="_new" style="color:#FBF9E4">Twitter</a></p><p><a href="https://slack.actionherojs.com/" target="_new" style="color:#FBF9E4">Slack</a></p><p><a href="https://github.com/Actionhero/Actionhero" target="_new" style="color:#FBF9E4">Github</a></p><p><a href="https://actionherojs.threadless.com" target="_new" style="color:#FBF9E4">Shop</a></p></div></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"markdown":"## Overview\n\n```ts\n// A simple Action\n\nimport { Action } from \"actionhero\";\n\nexport class RandomNumber extends Action {\n  constructor() {\n    super();\n    this.name = \"randomNumber\";\n    this.description = \"I am an API method which will generate a random number\";\n    this.outputExample = { randomNumber: 0.1234 };\n  }\n\n  async run({ response }) {\n    response.randomNumber = Math.random();\n  }\n}\n```\n\nThe core of Actionhero is the Action framework, and **actions** are the basic units of work. All connection types from all servers can use actions. This means that you only need to write an action once, and both HTTP clients and websocket clients can consume it!\n\nThe goal of an action is to read `data.params` (which are the arguments a connection provides), do work, and set the `data.response` (and `data.response.error` when needed) values to build the response to the client.\n\nYou can create you own actions by placing them in a `./actions/` folder at the `src` directory of your application. You can use the generator with `actionhero generate action --name=myAction`\n\nYou can also define more than one action per file if you would like, and extend classes to share common methods and components (like input parsers).\n\n```js\n// A compound Action with Shared Inputs\n\nimport { Action } from \"actionhero\";\n\nclass ValidatedAction extends Action {\n  constructor() {\n    super();\n\n    this.inputs = {\n      email: {\n        required: true,\n        validator: this.emailValidator\n      },\n      password: {\n        required: true,\n        validator: this.passwordValidator\n      }\n    };\n  }\n\n  emailValidator(param) {\n    if (param.indexOf(\"@\") \u003c 0) {\n      throw new Error(\"that is not a valid email address\");\n    }\n  }\n\n  passwordValidator(param) {\n    if (param.length \u003c= 4) {\n      throw new Error(\"password should be at least 4 letters long\");\n    }\n  }\n}\n\n// the actions\nexport class UserAdd extends ValidatedAction {\n  constructor() {\n    super();\n    this.name = \"userAdd\";\n    this.description = \"I add a user\";\n  }\n\n  run(data) {\n    // your code here\n  }\n}\n\nexport class UserDelete extends ValidatedAction {\n  constructor() {\n    super();\n    this.name = \"userDelete\";\n    this.description = \"I delete a user\";\n  }\n\n  run(data) {\n    // your code here\n  }\n}\n```\n\n## Versions\n\nActionhero supports multiple versions of the same action. This will allow you to support actions/routes of the same name with upgraded functionality. To create actions of the same name with various versions, set the `version` parameter.\n\n```js\nimport { Action } from \"actionhero\";\n\nexport class ActionVersion1 extends Action {\n  constructor() {\n    super();\n    this.name = \"randomNumber\";\n    this.description = \"I am an API method which will generate a random number\";\n    this.outputExample = { randomNumber: 0.123 };\n    this.version = 1;\n  }\n\n  async run({ connection, response }) {\n    response.version = 1;\n    response.randomNumber = Math.random();\n  }\n};\n\nexports class ActionVersion2 extends Action {\n  constructor() {\n    super();\n    this.name = \"randomNumber\";\n    this.description = \"I am an API method which will generate a random number\";\n    this.outputExample = { randomNumber: 0.123 };\n    this.version = 2;\n  }\n\n  async run({ connection, response }) {\n    response.version = 2;\n    const number = Math.random();\n    response.randomNumber = connection.localize([\n      \"Your random number is {{number}}\", { number }\n    ]);\n  }\n};\n```\n\n- actions optionally have the `this.version` attribute, which defaults to `1`.\n- a reserved param, `apiVersion` is used to directly specify the version of an action a client may request. You will likely want to check this in your `routes` file\n- if a client doesn't specify an `apiVersion`, they will be directed to the highest numerical version of that action.\n\nYou can optionally create routes to handle your API versioning:\n\n_As a note, if a client accessing Actionhero via routes does not provide an apiVersion and it is explicitly defined in the route, the highest number will not be assigned automatically, and will be seen as a routing error._\n\n```js\nexports.routes = {\n  all: [\n    // creates routes like \\`/api/myAction/1/\\` and \\`/api/myAction/2/\\`\n    { path: \"/myAction/:apiVersion\", action: \"myAction\" },\n\n    // creates routes like \\`/api/v1/myAction/\\` and \\`/api/v2/myAction/\\`\n    { path: \"/v:apiVersion/myAction\", action: \"myAction\" }\n  ]\n};\n```\n\nWe go into more detail about routes when discussing the [web server](/tutorials/web-server)\n\n## Options\n\nThe complete set of options an action can have are:\n\n```js\nimport { Action } from \"actionhero\";\n\nclass ValidatedAction extends Action {\n  constructor () {\n    super()\n\n    // (required) the action's name (the \\`exports\\` key doesn't matter)\n    this.name = 'randomNumber'\n\n    // (required) the description\n    this.description = 'I am an API method which will generate a random number'\n\n    // (required) a hash of all the inputs this action will accept\n    // any inputs provided to the action not in this hash will be stripped\n    this.inputs = {\n      multiplier: {\n        required: false,\n        validator: (param, connection, actionTemplate) =\u003e {\n          if (param \u003c 0) { throw new Error('must be \u003e 0') }\n        },\n        formatter: (param, connection, actionTemplate) =\u003e {\n          return parseInt(param)\n        },\n        default: (param, connection, actionTemplate) =\u003e {\n          return 1\n        },\n      }\n    },\n\n    // any middleware to apply before/after this action\n    // global middleware will be applied automatically\n    // default []\n    this.middleware = []\n\n    // an example response\n    // default: {}\n    this.outputExample = { randomNumber: 123 }\n\n    // you can choose to block certain servers from using this action\n    // default: []\n    this.blockedConnectionTypes = ['webSocket']\n\n    // how should this action be logged?\n    // default: 'info'\n    this.logLevel = 'warning'\n\n    // (HTTP only) if the route for this action includes an extension (like .jpg), should the response MIME be adjusted to match?\n    // default: true\n    this.matchExtensionMimeType = true\n\n    // should this action appear within \\`api.documentation\\`\n    // default: true\n    this.toDocument = true\n\n    // (required) the run method of the action\n    async run (data) {\n      data.response.randomNumber = Math.random() * data.params.multiplier;\n    }\n  }\n}\n```\n\n## Inputs\n\n```js\naction.inputs = {\n  // a simple input\n  // defaults assume required = false\n  minimalInput: {}\n\n  // a complex input\n  multiplier: {\n    required: true,\n    validator: (param, connection, actionTemplate) =\u003e {\n      if (param \u003c 0) { throw new Error('must be \u003e 0') }\n    },\n    formatter: (param, connection, actionTemplate) =\u003e {\n      return parseInt(param);\n    },\n    default: (param, connection, actionTemplate) =\u003e {\n      return 1;\n    },\n  },\n\n  // a schema input\n  schemaInput: {\n    required: true,\n    default: {},\n    schema: {\n      nestedInput: {\n        required: true,\n        default: 1,\n        validator: (param, connection, actionTemplate) =\u003e {\n          if (param \u003c 0) { throw new Error('must be \u003e 0') }\n        },\n        formatter: (param, connection, actionTemplate) =\u003e {\n          return parseInt(param);\n        },\n      },\n      otherInput: {},\n    }\n  }\n};\n```\n\nThe properties of an input are:\n\n- `required` (boolean)\n  - Default: `false`\n- `formatter = function(param, connection, actionTemplate)`\n  - will return the new value of the param\n  - Default: The parameter is not reformatted\n- `default = function(param, connection, actionTemplate)`\n  - will return the default value of the param\n  - you can also have a static assignment for `default` father than a function, ie: `default: 123`\n  - Default: Parameter has no default value\n- `validator = function(param, connection, actionTemplate)`\n  - should return true, null, or undefined (return nothing) if validation passed\n  - should throw an error message if validation fails which will be returned to the client\n  - Default: Parameter is always valid\n- `schema` (object)\n  - optional nested inputs definition\n  - accept `object` similar to regular input\n  - nested input also have properties: `required`, `formatter`, `default` and `validator`\n\nYou can define `config.general.missingParamChecks = [null, '', undefined]` to choose explicitly how you want un-set params to be handled in your actions. For example, if you want to allow explicit `null` values in a JSON payload but not `undefined`, you can now opt-in to that behavior. This is what `action.inputs.x.required = true` will check against.\u003c/p\u003e\n\nSince all properties of an input are optional, the smallest possible definition of an input is: `name : {}`. However, you should usually specify that an input is required (or not), ie: `{`name: {required: false}`}`.\u003c/p\u003e\n\nThe methods `default`, `formatter`, and `validator` have the api object set as `this` within their scopes. This means that you can define common formatters within middleware and reference them in each action.\u003c/p\u003e\n\nThe methods are applied in this order:\u003c/p\u003e\n\n- `default()`\n- `formatter()`\n- `validator()`\n- `required()`\n\nHere's an example...\n\n```js\nmoneyInCents: {\n  required:  true,\n  default:   (p) =\u003e { return 0 },\n  formatter: (p) =\u003e { return parseFloat(p) },\n  validator: (p) =\u003e {\n    if(isNaN(parseFloat(p)){ throw new Error('not a number') }\n    if(p \u003c 0){ throw new Error('money cannot be negative') }\n  }\n}\n```\n\nFormatters and Validators can also be named method names. For example, you might have an action like:\n\n```js\ninputs: {\n  key: {\n    required: true,\n    formatter: 'api.formatter.uniqueKeyName'\n  }\n}\n```\n\nYou can define `api.formatter.uniqueKeyName` elsewhere in your project.\n\nExample schema input:\n\n```js\ninputs = {\n  firstName: { required: true },\n  lastName: { required: false },\n  username: { required: true },\n  address: {\n    required: false,\n    schema: {\n      country: {\n        required: true,\n        default: \"USA\"\n      },\n      state: { required: false },\n      city: {\n        required: true,\n        formatter: val =\u003e `City:\\${val}`,\n        validator: val =\u003e val.length \u003e 10\n      }\n    }\n  }\n};\n```\n\n## Extending the Action class\n\nThere may be times that you want add properties to the Action class. A common reason for this is to work with middleware, adding a property to your action that controls how authentication might work, etc. With typescript, adding arbitrary properties to class (interface) will produce an error, as we don't have a type definition for your new property. The way to overcome this is to extend the Action class with your new property.\n\nThe example below creates a new class, `AuthenticatedAction` which adds a boolean `authenticated` to the action. A global action middleware then checks if the action should be `authenticated`, and if it does, it checks for a password.\n\n```ts\nimport { Action, action } from \"actionhero\";\n\nabstract class AuthenticatedAction extends Action {\n  /**\n   * does this action require the user to be logged in?\n   */\n  authenticated: boolean;\n}\n\naction.addMiddleware({\n  name: \"Authentication Middleware\",\n  global: true,\n  preProcessor({ params, actionTemplate }) {\n    // we have access to the action's template here, which now will contain \"authenticated: boolean\"\n    if (actionTemplate.authenticated) {\n      if (params.password !== \"thePassw0rd\") {\n        // it the request does not include the param \"password=thePassw0rd\", the action will not be run\n        // this is bad authentication strategy, but hopefully serves as a good example\n        throw new Error(\"bad password\");\n      }\n    }\n  }\n});\n\nexport class ShowDashboard extends AuthenticatedAction {\n  constructor() {\n    super();\n    this.name = \"showDashboard\";\n    this.description = \"I return the authenticated user's dashboard data\";\n    // without the AutheticatedAction class, this would throw an error, as \"authenticated\" is not a property of the class \"Action\"\n    this.authenticated = true;\n  }\n\n  async run({ response }) {\n    // your logic would be here...\n    response.dashboard = true;\n  }\n}\n\n/**\n * ❯ curl \"http://localhost:8080/api/showDashboard\"\n * { \"error\": \"bad password\" }\n *\n * ❯ curl \"http://localhost:8080/api/showDashboard?password=thePassw0rd\"\n * { \"dashboard\": true }\n */\n```\n\n## The Data Object\n\nThe `data` object passed into your action captures the state of the connection at the time the action was started. Middleware preProcessors have already fired, and input formatting and validation has occurred. Here are the properties of the `data` object.\n\n```js\ndata = {\n  connection: connection,\n  action: \"randomNumber\",\n  toProcess: true,\n  toRender: true,\n  messageId: 123,\n  params: { action: \"randomNumber\", apiVersion: 1 },\n  actionStartTime: 123,\n  response: {},\n  session: {}\n};\n```\n\nThe goal of most actions is to do work and then modify the value of `data.response`, which will eventually be sent down to the client.\n\nYou can also modify properties of the connection by accessing `data.connection`, IE changing the response header for a HTTP request.\n\nIf you don't want your action to respond to the client, or you have already sent data to the client (perhaps you already rendered a file to them or sent an error HTTP header), you can set `data.toRender = false;`\n\nIf you are certain that your action is only going to be handled by a web server, then a convenience method has been provided to you via `data.connection.setHeader()`. This function is a proxy to the \u003ca href='https://nodejs.org/api/http.html#http_response_setheader_name_value'\u003eNode HTTP Response setHeader\u003c/a\u003e function and allows you to set response headers without having to drill into the `data.connection.rawConnection` object. Please be aware, the `data.connection.setHeader()` function will only be available if your action is being handled by a web server. Other server types will throw an exception. See [Servers: Customizing the Connection](/tutorial/servers) for more details.\n\nSimilarly to the above, the web server also exposes `data.connection.setStatusCode()`, again only for actions in use by the web server. This can be used as a helper to set the HTTP responses' status code, ie: 404, 200, etc.\n\nFinally, if your action is again only for the web server, you can send a string or buffer as a file response with `data.connection.pipe(buffer, headers)`. You will still need to set `data.toRender = false` in your action to avoid double-sending a response to the client.\n\n## Middleware\n\nYou can create middleware which would apply to the connection both before and after an action. Middleware can be either global (applied to all actions) or local, specified in each action via `action.middleware = []`. Supply the `names` of any middleware you want to use.\n\nYou can [learn more about middleware here](/tutorials/middleware).\n\n## Notes\n\n- Actions' run methods are async, and have `data` as their only argument. Completing an action is as simple returning from the method.\n- If you throw an error, be sure that it is a `new Error()` object, and not a string. Thrown errors will automatically be sent to the client in `response.error`. Also, throw Errors are processed at `config/errors.js` in `genericError(data, error)`. Here you can check your error add to the response (`requestIds`, status codes, etc.)\n- The metadata `outputExample` is used in reflexive and self-documenting actions in the API, available via the `documentation` verb (and showDocumentation action).\n- You can limit how many actions a persistent client (websocket, tcp, etc) can have pending at once with `api.config.general.simultaneousActions`\n- `actions.inputs` are used for both documentation and for building the whitelist of allowed parameters the API will accept. Client params not included in these whitelists will be ignored for security. If you wish to disable the whitelisting you can use the flag at `api.config.general.disableParamScrubbing`. Note that [Middleware](tutorial-middleware.html) preProcessors will always have access to all params pre-scrubbing.\n- `matchExtensionMimeType` is currently only used by the `web` server, and it indicates that if this action is successfully called by a client with `connection.extension` set, the headers of the response should be changed to match that file type. This is useful when creating actions that download files.\n- Actionhero strives to keep the `data.connection` object uniform among various client types, and more importantly, present `data.params` in a homogeneous way to actions. You can inspect `data.connection.type` to learn more about the connection. The gory details of the connection (which vary on its type) are stored in `data.connection.rawConnection` which will contain the websocket, tcp connection, etc. For web clients, `{`data.connection.rawConnection = {req: req, res: res}`}` for example.\n\n[You can learn more about handling HTTP verbs and file uploads here](/tutorials/web-server) and [Web-Socket Clients](/tutorials/websocket-server).\n","name":"actions"}},"page":"/tutorials/[name]","query":{"name":"actions"},"buildId":"AUafT0fS7I7zOGsKXeKYu","nextExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-724d884f9cbfd0f2db1d.js"></script><script async="" data-next-page="/tutorials/[name]" src="/_next/static/AUafT0fS7I7zOGsKXeKYu/pages/tutorials/%5Bname%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/AUafT0fS7I7zOGsKXeKYu/pages/_app.js"></script><script src="/_next/static/runtime/webpack-91b117697e716c22a78b.js" async=""></script><script src="/_next/static/chunks/framework.dbd31ae8fa0e794339d4.js" async=""></script><script src="/_next/static/chunks/commons.951ee3a86146f43ff3ef.js" async=""></script><script src="/_next/static/runtime/main-a439f05c489a40fb8abf.js" async=""></script><script src="/_next/static/chunks/f5647245c8a086598a5876f74a9756c478cda1e9.df8ba5aacf2336156dd7.js" async=""></script><script src="/_next/static/chunks/7ece71603c6e374212d15adca87bfaf90f52a690.fee39761db1fc475c2ba.js" async=""></script><script src="/_next/static/chunks/48e7449b7a97b90df8cdc3151e72c92ec49f3594.f4cec1a1186f868c77e4.js" async=""></script><script src="/_next/static/AUafT0fS7I7zOGsKXeKYu/_buildManifest.js" async=""></script></body></html>