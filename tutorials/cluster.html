<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="57x57" href="/static/images/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/images/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/images/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/images/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/images/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/images/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/images/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/images/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/images/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/images/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/images/icons/favicon-16x16.png"/><meta name="viewport" content="width=device-width"/><link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css"/><link rel="stylesheet" type="text/css" href="/static/css/bebasNeue.css"/><link rel="stylesheet" type="text/css" href="/static/css/animations.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Roboto:100,300,400,500,700,900" rel="stylesheet"/><title>Actionhero</title><script src="/static/js/googleAnalytics.js"></script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/rBG1kROSC3gyhKedsHZHG/pages/tutorials/%5Bname%5D.js" as="script"/><link rel="preload" href="/_next/static/rBG1kROSC3gyhKedsHZHG/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-08f7b238829422e3b9b2.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.0d6431e02eb2f5f9b82f.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-2325b25da04a50e601b5.js" as="script"/></head><body><div id="__next"><div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="text-align:center;padding:10px;background-color:#FFFFFF;border-bottom:5px solid #E14E3A"><p><strong>Actionhero is moving to Typescript in v21!</strong><br/>To learn more about the new features and the upgrade process, visit the<!-- --> <a href="/tutorials/typescript">Typescript Tutorial</a>.</p></div><header style="background-color:#2F5266"><div class="container"><nav style="background-color:#2F5266;padding-top:5px;margin-bottom:10px;border:0" class="navbar navbar-default"><div class="container"><div class="navbar-header"><a style="padding-top:0;margin-bottom:15px" class="navbar-brand"><img src="/static/images/actionhero-logo-header-wordmark.svg" style="padding-top:14px;padding-bottom:20px"/></a><button type="button" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"></ul><ul class="hidden-md hidden-sm hidden-xs nav navbar-nav navbar-left"><li role="presentation" class=""><a role="button" href="#"> </a></li><li role="presentation" class=""><a role="button" href="#"> </a></li></ul><ul class="nav navbar-nav navbar-left"><li role="presentation" class="hidden-sm"><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Why Actionhero</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Downloads</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Tutorials</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Documentation</span></a></li><li role="presentation" class="hidden-sm"><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Plugins</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Community</span></a></li><li role="presentation" class=""><a role="button" href="#"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300">Shop</span></a></li></ul><ul class="nav navbar-nav navbar-right"><div><a style="text-decoration:none" href="/get-started"><button style="font-family:Roboto, sans-serif;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;font-weight:300;margin-top:20px;margin-bottom:0;margin-left:10px;margin-right:10px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Get Started</button></a></div></ul></div></div></nav></div></header></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="background-color:#FBF9E4;color:#2F5266;font-weight:200;padding:50px"><div class="container"><div class="row"><div style="text-align:center" class="col-md-3"><img src="/static/images/cluster-ready.svg"/></div><div style="text-align:center" class="col-md-6"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><br/>Cluster</h1></div><div class="col-md-3"></div></div></div></div><div style="height:183px;background:url(&quot;/static/images/clouds-white.svg&quot;) no-repeat center #FBF9E4"></div><div style="padding-bottom:100px" class="container"><div class="row"><div id="_top"></div><div id="docPageContent" class="col-md-12"><div class="row"><div class="col-md-9"><div><br/><h2 id="Overview" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Overview</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div><p><strong><em>AKA: Running Actionhero in a Cluster</em></strong></p><p>Actionhero can be run either as a solitary server or as part of a cluster. The goal of these cluster helpers is to allow you to create a group of servers which will share state and each be able to handle requests and run tasks. You can add or remove nodes from the cluster without fear of data loss or task duplication. You can also run many instances of Actionhero on the same server using node.js cluster methods (<code>actionhero start cluster</code>), which you <a href="/tutorials/production-notes">can learn more about here</a>.</p><p>Cluster instances are named sequentially, starting with <code>actionhero-worker-1</code>, and can be retrieved from &#x27;api.id&#x27;. Logs and PID&#x27;s, as well as other instance-specific information follow this pattern as well.</p><div><br/><h2 id="Cache" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Cache</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div><p>Using a <a href="http://redis.io">redis</a> backend, Actionhero nodes share memory objects (using the <code>cache</code>) and have a common queue for tasks. This means that all peers will have access to all data stored in the cache. The task system also becomes a common queue which all peers will work on draining. There should be no changes required to deploy your application in a cluster.</p><p>Keep in mind that many clients/server can access a cached value simultaneously, so build your actions carefully not to have conflicting state. You can <a href="/tutorails/cache">learn more about the cache methods here</a>. You can also <a href="/tutorials/production-notes">review recommendations about Production Redis configurations</a>.</p><div><br/><h2 id="RPC" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">RPC</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div><p>In version 9.0.0, Actionhero introduced Remote Procedure Calls, or RPC for short. You can call an RPC method to be executed on all nodes in your cluster or just a node which holds a specific connection. You can call RPC methods with the <code>redis.doCluster</code> method. If you provide the optional callback, you will get the first response back (or a timeout error). RPC calls are invoked with <code>redis.doCluster(method, args, connectionId, waitForResponse)</code>.</p><p>For example, if you wanted all nodes to log a message, you would do: <code>redis.doCluster(&#x27;api.log&#x27;, [&quot;hello from &quot; + api.id])</code></p><p>If you wanted the node which holds connection <code>abc123</code> to change their <code>authorized</code> status (perhaps because your room authentication relies on this), you would do:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#408080;font-style:italic">// This will ask all nodes connected to the cluster if they have connection #\`abc123\`</span>
<span style="color:#408080;font-style:italic">//   and if they do, run \`connection.set(&#x27;auth&#x27;, true)\` on it</span>
<span style="color:#954121">await</span> connections.apply(<span style="color:#219161">&quot;abc123&quot;</span>, <span style="color:#219161">&quot;set&quot;</span>, [<span style="color:#219161">&quot;auth&quot;</span>, <span style="color:#954121">true</span>]);</code></pre><p>The RPC system is used heavily by Chat.</p><p>Two options have been added to the <code>config/redis.js</code> config file to support this: <code>config.general.channel</code> ( Which channel to use on redis pub/sub for RPC communication ) and <code>config.general.rpcTimeout</code> ( How long to wait for an RPC call before considering it a failure )</p><p><strong>WARNING</strong></p><p>RPC calls are authenticated against <code>config.serverToken</code> and communication happens over redis pub/sub. BE CAREFUL, as you can call <em>any</em> method within the API namespace on an Actionhero server, including shutdown() and read <em>any</em> data on that node.</p><div><br/><h2 id="Connections" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Connections</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div><p>Some special RPC tools have been added so that you can interact with connections across multiple nodes. Specifically the chat sub-system needs to be able to boot and move connections into rooms, regardless of which node they are connected to.</p><p>Actionhero has exposed <code>connections.apply</code> which can be used to retrieve data about and modify a connection on any node.</p><p><strong><code>connections.apply(connectionId, method, args)</code></strong></p><ul><li><a href="api.connections.html">Learn More</a></li><li>connectionId is required</li><li>Both <code>method</code> and <code>args</code> can be ignored if you just want to retrieve information about a connection, IE: <code>const connectionDetails = await api.connections.apply(connectionId)</code></li></ul><div><br/><h2 id="PubSub" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">PubSub</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">import</span> { redis } <span style="color:#954121">from</span> <span style="color:#219161">&quot;actionhero&quot;</span>;

<span style="color:#408080;font-style:italic">// To subscribe to messages, add a callback for your \`messageType\`, IE:</span>
redis.subscriptionHandlers[<span style="color:#219161">&quot;myMessageType&quot;</span>] = <span class="hljs-function"><span style="color:#954121">function</span>(<span style="color:#00f">message</span>) </span>{
  <span style="color:#408080;font-style:italic">// do stuff</span>
};

<span style="color:#408080;font-style:italic">// send a message</span>
<span style="color:#954121">const</span> payload = {
  <span class="hljs-attr">messageType</span>: <span style="color:#219161">&quot;myMessageType&quot;</span>,
  <span class="hljs-attr">serverId</span>: api.id,
  <span class="hljs-attr">serverToken</span>: api.config.general.serverToken,
  <span class="hljs-attr">message</span>: <span style="color:#219161">&quot;hello!&quot;</span>
};

<span style="color:#954121">await</span> api.redis.publish(payload);</code></pre><p>Actionhero also uses redis to allow for pub/sub communication between nodes.</p><p>You can broadcast and receive messages from other peers in the cluster:</p><p><strong><code>redis.publish(payload)</code></strong></p><ul><li><a href="api.redis.html">Learn More</a></li><li>payload must contain:<ul><li><code>messageType</code> : the name of your payload type,</li><li><code>serverId</code> : <code>api.id</code>,</li><li><code>serverToken</code> : <code>api.config.general.serverToken</code>,</li></ul></li></ul></div><div class="col-md-3"><div style="padding-top:90px"><ul style="list-style-type:none;padding-left:0;margin-left:0"></ul></div></div></div><hr/><p>Back to<!-- --> <a href="/tutorials">Tutorials</a></p></div><div class="hidden-xs hidden-sm col-md-3"></div></div></div><div style="background-color:#6E8898;color:#2F5266;font-weight:300;padding-top:100px;padding-bottom:100px"><div class="container"><div class="row"><div class="col-md-2"></div><div style="text-align:center;color:#FBF9E4;padding-bottom:100px" class="col-md-8"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Solutions</h1><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="color:#FBF9E4">Actionhero was built from the ground up to include all the features you expect from a modern API framework.</span></h2></div><div class="col-md-2"></div></div><div class="row"><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-left:40px;padding-right:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Open Source</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>The Actionhero server is open source, under the Apache-2 license</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>Actionhero runs on Linux, OS X, and Windows</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>You always have access to the Actionhero team via<!-- --> <a href="/community">Slack and Github</a></p><br/><br/><div><a style="text-decoration:none" href="/downloads"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Download</button></a></div></div></div><div class="hidden-md hidden-lg hidden-xl col-md-4"><div style="width:100%;padding:20px;background-color:#2F5266;color:#FFFFFF;box-shadow:0px 2px 4px #003C51"><div style="text-align:center"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><span style="color:#FBF9E4">Premium Training &amp; Review</span></h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Audits</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div><div class="hidden-xs hidden-sm col-md-4"><div style="width:125%;padding:40px;background-color:#2F5266;color:#FFFFFF;position:relative;top:-60px;box-shadow:0px 2px 4px #003C51;margin-left:-13%;margin-right:-5%;z-index:10"><div style="text-align:center;padding-bottom:10px"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Premium Training &amp; Review</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corperate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Workshops</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-right:40px;padding-left:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Enterprise</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>For larger customers in need of a support contract, we offer an enterprise plan including everything in the Premium plan plus:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>24/7 access to core members of the Actionhero Team</strong></li><li><strong>Emergency response packages</strong></li><li><strong>Deployment support</strong></li><li><strong>...and custom development against Actionhero’s core as needed.</strong></li></ul><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-lg btn-default btn-block">Contact Us</button></div></div></div></div></div></div></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><footer id="footer-container" style="background-color:#2F5266;color:#FBF9E4;font-family:Roboto, sans-serif;font-weight:200"><div class="container"><div style="padding-bottom:50px;padding-top:50px;padding-left:100px" class="row"><div class="col-md-12"><img src="/static/images/actionhero-logo-header-wordmark.svg"/></div></div><div style="padding-bottom:100px" class="row"><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/terms">Terms</a></p><p>Contact us at<!-- --> <a style="color:#FBF9E4;font-weight:500" href="mailto:hello@actionherojs.com">hello@actionherojs.com</a></p><p><a href="https://medium.com/tag/actionherojs/latest" target="_new" style="color:#FBF9E4">Blogs</a></p><p>© 2019<!-- --> <!-- -->Actionhero</p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/why">Why Actionhero</a></p><p><a style="color:#FBF9E4" href="/get-started">Get Started</a></p><p><a href="https://docs.actionherojs.com" style="color:#FBF9E4">Documenation</a></p><p><a style="color:#FBF9E4" href="/solutions">Solutions</a></p><p><a style="color:#FBF9E4" href="/community">Community</a></p><p><a style="color:#FBF9E4" href="/downloads">Downloads</a></p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a href="https://www.npmjs.com/package/Actionhero" target="_new" style="color:#FBF9E4">NPM</a></p><p><a href="https://twitter.com/actionherojs" target="_new" style="color:#FBF9E4">Twitter</a></p><p><a href="https://slack.actionherojs.com/" target="_new" style="color:#FBF9E4">Slack</a></p><p><a href="https://github.com/Actionhero/Actionhero" target="_new" style="color:#FBF9E4">Github</a></p><p><a href="https://actionherojs.threadless.com" target="_new" style="color:#FBF9E4">Shop</a></p></div></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{"markdown":"## Overview\n\n**_AKA: Running Actionhero in a Cluster_**\n\nActionhero can be run either as a solitary server or as part of a cluster. The goal of these cluster helpers is to allow you to create a group of servers which will share state and each be able to handle requests and run tasks. You can add or remove nodes from the cluster without fear of data loss or task duplication. You can also run many instances of Actionhero on the same server using node.js cluster methods (`actionhero start cluster`), which you [can learn more about here](/tutorials/production-notes).\n\nCluster instances are named sequentially, starting with `actionhero-worker-1`, and can be retrieved from 'api.id'. Logs and PID's, as well as other instance-specific information follow this pattern as well.\n\n## Cache\n\nUsing a [redis](http://redis.io) backend, Actionhero nodes share memory objects (using the `cache`) and have a common queue for tasks. This means that all peers will have access to all data stored in the cache. The task system also becomes a common queue which all peers will work on draining. There should be no changes required to deploy your application in a cluster.\n\nKeep in mind that many clients/server can access a cached value simultaneously, so build your actions carefully not to have conflicting state. You can [learn more about the cache methods here](/tutorails/cache). You can also [review recommendations about Production Redis configurations](/tutorials/production-notes).\n\n## RPC\n\nIn version 9.0.0, Actionhero introduced Remote Procedure Calls, or RPC for short. You can call an RPC method to be executed on all nodes in your cluster or just a node which holds a specific connection. You can call RPC methods with the `redis.doCluster` method. If you provide the optional callback, you will get the first response back (or a timeout error). RPC calls are invoked with `redis.doCluster(method, args, connectionId, waitForResponse)`.\n\nFor example, if you wanted all nodes to log a message, you would do: `redis.doCluster('api.log', [\"hello from \" + api.id])`\n\nIf you wanted the node which holds connection `abc123` to change their `authorized` status (perhaps because your room authentication relies on this), you would do:\n\n```js\n// This will ask all nodes connected to the cluster if they have connection #\\`abc123\\`\n//   and if they do, run \\`connection.set('auth', true)\\` on it\nawait connections.apply(\"abc123\", \"set\", [\"auth\", true]);\n```\n\nThe RPC system is used heavily by Chat.\n\nTwo options have been added to the `config/redis.js` config file to support this: `config.general.channel` ( Which channel to use on redis pub/sub for RPC communication ) and `config.general.rpcTimeout` ( How long to wait for an RPC call before considering it a failure )\n\n**WARNING**\n\nRPC calls are authenticated against `config.serverToken` and communication happens over redis pub/sub. BE CAREFUL, as you can call _any_ method within the API namespace on an Actionhero server, including shutdown() and read _any_ data on that node.\n\n## Connections\n\nSome special RPC tools have been added so that you can interact with connections across multiple nodes. Specifically the chat sub-system needs to be able to boot and move connections into rooms, regardless of which node they are connected to.\n\nActionhero has exposed `connections.apply` which can be used to retrieve data about and modify a connection on any node.\n\n**`connections.apply(connectionId, method, args)`**\n\n- [Learn More](api.connections.html)\n- connectionId is required\n- Both `method` and `args` can be ignored if you just want to retrieve information about a connection, IE: `const connectionDetails = await api.connections.apply(connectionId)`\n\n## PubSub\n\n```js\nimport { redis } from \"actionhero\";\n\n// To subscribe to messages, add a callback for your \\`messageType\\`, IE:\nredis.subscriptionHandlers[\"myMessageType\"] = function(message) {\n  // do stuff\n};\n\n// send a message\nconst payload = {\n  messageType: \"myMessageType\",\n  serverId: api.id,\n  serverToken: api.config.general.serverToken,\n  message: \"hello!\"\n};\n\nawait api.redis.publish(payload);\n```\n\nActionhero also uses redis to allow for pub/sub communication between nodes.\n\nYou can broadcast and receive messages from other peers in the cluster:\n\n**`redis.publish(payload)`**\n\n- [Learn More](api.redis.html)\n- payload must contain:\n  - `messageType` : the name of your payload type,\n  - `serverId` : `api.id`,\n  - `serverToken` : `api.config.general.serverToken`,\n","name":"cluster"}},"page":"/tutorials/[name]","query":{"name":"cluster"},"buildId":"rBG1kROSC3gyhKedsHZHG","nextExport":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-099147a670e7b68459d6.js"></script><script async="" data-next-page="/tutorials/[name]" src="/_next/static/rBG1kROSC3gyhKedsHZHG/pages/tutorials/%5Bname%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/rBG1kROSC3gyhKedsHZHG/pages/_app.js"></script><script src="/_next/static/runtime/webpack-08f7b238829422e3b9b2.js" async=""></script><script src="/_next/static/chunks/commons.0d6431e02eb2f5f9b82f.js" async=""></script><script src="/_next/static/runtime/main-2325b25da04a50e601b5.js" async=""></script></body></html>